import{_ as Be,r as c,x as Z,c as $,a as S,b as e,w as t,d as i,e as u,i as U,m as Ie,y as Me,n as $e,p as Ee,f as s,z as Ne,A as Re,G as qe,B as Fe,H as je,g as Ke,t as d,h as j,E as V,C as E}from"./index-OILW0-7z.js";const Ae={class:"user-management-container"},He={class:"header-content"},Ge={class:"breadcrumb"},Je={class:"header-actions"},Oe={class:"card-header"},Qe={class:"user-count"},We={class:"filter-section"},Xe={class:"user-item"},Ye={class:"user-info"},Ze={class:"user-email"},el={class:"table-footer"},ll={key:0,class:"batch-actions"},tl={class:"pagination"},al={key:0,class:"user-detail"},nl={class:"detail-header"},ol={class:"detail-info"},il={class:"user-stats"},ul={class:"detail-content"},sl={key:0,class:"edit-form"},rl={__name:"UserManagement",setup(dl){const K=c("user-management"),x=c(""),y=c(""),D=c(""),C=c([]),N=c(!1),w=c([]),L=c(!1),P=c(!1),r=c(null),v=c(null),B=c(),f=c({currentPage:1,pageSize:10}),ee={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度在3到50个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]},g=c([{id:"1001",username:"admin",email:"admin@example.com",role:"admin",status:"active",avatar:"/logo.png",videoCount:0,viewCount:1560,followerCount:12,registrationDate:"2024-01-01 00:00:00",lastLoginTime:"2024-01-14 10:30:00",level:"VIP5",bio:"系统管理员"},{id:"1002",username:"zhangwei",email:"zhangwei@example.com",role:"user",status:"active",avatar:"/logo.png",videoCount:28,viewCount:35600,followerCount:256,registrationDate:"2024-01-02 14:23:00",lastLoginTime:"2024-01-13 18:45:00",level:"VIP3",bio:"热爱摄影和旅行的视频创作者"},{id:"1003",username:"lisi",email:"lisi@example.com",role:"reviewer",status:"active",avatar:"/logo.png",videoCount:5,viewCount:12300,followerCount:45,registrationDate:"2024-01-03 09:15:00",lastLoginTime:"2024-01-14 09:20:00",level:"VIP2",bio:"内容审核员"},{id:"1004",username:"wangwu",email:"wangwu@example.com",role:"user",status:"active",avatar:"/logo.png",videoCount:15,viewCount:28900,followerCount:178,registrationDate:"2024-01-04 16:40:00",lastLoginTime:"2024-01-12 21:30:00",level:"VIP2",bio:"科技爱好者，分享数码产品评测"},{id:"1005",username:"zhaoliu",email:"zhaoliu@example.com",role:"user",status:"disabled",avatar:"/logo.png",videoCount:8,viewCount:9800,followerCount:32,registrationDate:"2024-01-05 11:25:00",lastLoginTime:"2024-01-08 14:10:00",level:"VIP1",bio:"美食爱好者"},{id:"1006",username:"sunqi",email:"sunqi@example.com",role:"user",status:"inactive",avatar:"/logo.png",videoCount:0,viewCount:120,followerCount:0,registrationDate:"2024-01-10 19:30:00",lastLoginTime:null,level:"普通用户",bio:""},{id:"1007",username:"zhouba",email:"zhouba@example.com",role:"user",status:"active",avatar:"/logo.png",videoCount:42,viewCount:67800,followerCount:890,registrationDate:"2024-01-07 08:50:00",lastLoginTime:"2024-01-14 11:45:00",level:"VIP4",bio:"音乐制作人，分享音乐创作和乐器教学"},{id:"1008",username:"wujiu",email:"wujiu@example.com",role:"user",status:"active",avatar:"/logo.png",videoCount:12,viewCount:18900,followerCount:123,registrationDate:"2024-01-08 15:20:00",lastLoginTime:"2024-01-13 20:15:00",level:"VIP2",bio:"教育工作者，分享教学经验和学习方法"}]),A=Z(()=>{let a=[...g.value];if(x.value){const l=x.value.toLowerCase();a=a.filter(o=>o.username.toLowerCase().includes(l)||o.email.toLowerCase().includes(l))}if(y.value&&(a=a.filter(l=>l.role===y.value)),D.value&&(a=a.filter(l=>l.status===D.value)),C.value&&C.value.length===2){const l=new Date(C.value[0]),o=new Date(C.value[1]);o.setHours(23,59,59,999),a=a.filter(_=>{const z=new Date(_.registrationDate);return z>=l&&z<=o})}return a.sort((l,o)=>new Date(o.registrationDate)-new Date(l.registrationDate)),a}),le=Z(()=>{const a=(f.value.currentPage-1)*f.value.pageSize,l=a+f.value.pageSize;return A.value.slice(a,l)});function te(a){K.value=a,console.log("选择菜单:",a)}function H(){console.log("搜索关键词:",x.value),console.log("选择角色:",y.value),console.log("选择状态:",D.value),console.log("日期范围:",C.value),f.value.currentPage=1}function ae(){x.value="",y.value="",D.value="",C.value=[],f.value.currentPage=1}function ne(a){w.value=a}function oe(){N.value=!0,setTimeout(()=>{N.value=!1,V.success("数据已刷新")},500)}function ie(){V.success("用户数据导出成功"),console.log("导出用户数据")}function ue(a){r.value={...a},L.value=!0}function G(){L.value=!1,r.value=null}function se(a){v.value={...a},P.value=!0}function R(){B.value&&B.value.resetFields(),P.value=!1,v.value=null}function re(){B.value.validate(a=>{if(a){const l=g.value.findIndex(o=>o.id===v.value.id);if(l!==-1){const o=g.value[l];g.value[l]={...v.value,videoCount:o.videoCount,viewCount:o.viewCount,followerCount:o.followerCount,registrationDate:o.registrationDate,lastLoginTime:o.lastLoginTime,level:o.level,avatar:o.avatar},R(),V.success("用户信息已更新")}}else return console.log("表单验证失败"),!1})}function de(){E.confirm("确定要重置此用户的密码为默认密码吗？","重置密码",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{V.success("密码已重置为: 123456")}).catch(()=>{})}function ve(a){const l=a.status==="active"?"disabled":"active",o=l==="active"?"启用":"禁用";E.confirm(`确定要${o}用户 "${a.username}" 吗？`,"操作确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const _=g.value.findIndex(z=>z.id===a.id);_!==-1&&(g.value[_].status=l,V.success(`用户已${o}`))}).catch(()=>{})}function me(a){console.log("用户状态更新:",a.username,"新状态:",a.status)}function ce(){E.confirm(`确定要启用选中的 ${w.value.length} 个用户吗？`,"批量启用",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value.forEach(a=>{const l=g.value.findIndex(o=>o.id===a.id);l!==-1&&(g.value[l].status="active")}),w.value=[],V.success("批量启用成功")}).catch(()=>{})}function pe(){E.confirm(`确定要禁用选中的 ${w.value.length} 个用户吗？`,"批量禁用",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value.forEach(a=>{const l=g.value.findIndex(o=>o.id===a.id);l!==-1&&(g.value[l].status="disabled")}),w.value=[],V.success("批量禁用成功")}).catch(()=>{})}function fe(a){f.value.pageSize=a}function ge(a){f.value.currentPage=a}function q(a){return new Date(a).toLocaleString("zh-CN")}function J(a){return{admin:"管理员",user:"普通用户",reviewer:"审核员"}[a]||a}function _e(a){return{admin:"danger",user:"primary",reviewer:"warning"}[a]||"info"}function we(a){return{active:"正常",disabled:"禁用",inactive:"未激活"}[a]||a}return(a,l)=>{const o=i("el-icon"),_=i("el-menu-item"),z=i("videoplay"),be=i("el-menu"),Ce=i("el-aside"),O=i("el-breadcrumb-item"),he=i("el-breadcrumb"),p=i("el-button"),Ve=i("el-header"),I=i("el-input"),m=i("el-option"),M=i("el-select"),xe=i("el-date-picker"),b=i("el-table-column"),Q=i("el-avatar"),W=i("el-tag"),ye=i("el-switch"),De=i("el-table"),ze=i("el-pagination"),ke=i("el-card"),Ue=i("el-main"),X=i("el-container"),F=i("el-statistic"),Te=i("el-divider"),h=i("el-descriptions-item"),Se=i("el-descriptions"),Y=i("el-dialog"),k=i("el-form-item"),Le=i("el-form"),Pe=je("loading");return S(),$("div",Ae,[e(X,{class:"main-container"},{default:t(()=>[e(Ce,{width:"240px",class:"sidebar"},{default:t(()=>[l[18]||(l[18]=u("div",{class:"sidebar-header"},[u("h2",null,"视频管理系统")],-1)),e(be,{"default-active":K.value,class:"el-menu-vertical",onSelect:te},{default:t(()=>[e(_,{index:"dashboard"},{default:t(()=>[e(o,null,{default:t(()=>[e(U(Ie))]),_:1}),l[13]||(l[13]=u("span",null,"数据概览",-1))]),_:1}),e(_,{index:"video-management"},{default:t(()=>[e(o,null,{default:t(()=>[e(z)]),_:1}),l[14]||(l[14]=u("span",null,"视频管理",-1))]),_:1}),e(_,{index:"pending-videos"},{default:t(()=>[e(o,null,{default:t(()=>[e(U(Me))]),_:1}),l[15]||(l[15]=u("span",null,"待审核视频",-1))]),_:1}),e(_,{index:"user-management"},{default:t(()=>[e(o,null,{default:t(()=>[e(U($e))]),_:1}),l[16]||(l[16]=u("span",null,"用户管理",-1))]),_:1}),e(_,{index:"category-management"},{default:t(()=>[e(o,null,{default:t(()=>[e(U(Ee))]),_:1}),l[17]||(l[17]=u("span",null,"分类管理",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),e(X,null,{default:t(()=>[e(Ve,{height:"60px",class:"header"},{default:t(()=>[u("div",He,[u("div",Ge,[e(he,{separator:"/"},{default:t(()=>[e(O,{to:{path:"/admin"}},{default:t(()=>[...l[19]||(l[19]=[s("首页",-1)])]),_:1}),e(O,null,{default:t(()=>[...l[20]||(l[20]=[s("用户管理",-1)])]),_:1})]),_:1})]),u("div",Je,[e(p,{type:"warning",onClick:ie},{default:t(()=>[e(o,null,{default:t(()=>[e(U(Ne))]),_:1}),l[21]||(l[21]=s(" 导出数据 ",-1))]),_:1}),e(p,{type:"primary",onClick:oe},{default:t(()=>[e(o,null,{default:t(()=>[e(U(Re))]),_:1}),l[22]||(l[22]=s(" 刷新 ",-1))]),_:1})])])]),_:1}),e(Ue,{class:"content"},{default:t(()=>[e(ke,null,{header:t(()=>[u("div",Oe,[l[23]||(l[23]=u("span",null,"用户管理",-1)),u("span",Qe,"（共 "+d(g.value.length)+" 个用户）",1)])]),default:t(()=>[u("div",We,[e(I,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=n=>x.value=n),placeholder:"搜索用户名或邮箱",class:"search-input","prefix-icon":"Search",onKeyup:Fe(H,["enter"])},null,8,["modelValue"]),e(M,{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=n=>y.value=n),placeholder:"选择角色",class:"role-select"},{default:t(()=>[e(m,{label:"所有角色",value:""}),e(m,{label:"管理员",value:"admin"}),e(m,{label:"普通用户",value:"user"}),e(m,{label:"审核员",value:"reviewer"})]),_:1},8,["modelValue"]),e(M,{modelValue:D.value,"onUpdate:modelValue":l[2]||(l[2]=n=>D.value=n),placeholder:"选择状态",class:"status-select"},{default:t(()=>[e(m,{label:"所有状态",value:""}),e(m,{label:"正常",value:"active"}),e(m,{label:"禁用",value:"disabled"}),e(m,{label:"未激活",value:"inactive"})]),_:1},8,["modelValue"]),e(xe,{modelValue:C.value,"onUpdate:modelValue":l[3]||(l[3]=n=>C.value=n),type:"daterange","range-separator":"至","start-placeholder":"注册开始日期","end-placeholder":"注册结束日期",class:"date-picker"},null,8,["modelValue"]),e(p,{type:"primary",onClick:H},{default:t(()=>[...l[24]||(l[24]=[s("搜索",-1)])]),_:1}),e(p,{onClick:ae},{default:t(()=>[...l[25]||(l[25]=[s("重置",-1)])]),_:1})]),qe((S(),Ke(De,{data:le.value,style:{width:"100%"},onSelectionChange:ne},{default:t(()=>[e(b,{type:"selection",width:"55"}),e(b,{prop:"id",label:"用户ID",width:"100"}),e(b,{prop:"username",label:"用户名","min-width":"150"},{default:t(n=>[u("div",Xe,[e(Q,{size:40,src:n.row.avatar,class:"user-avatar"},null,8,["src"]),u("div",Ye,[u("div",null,d(n.row.username),1),u("div",Ze,d(n.row.email),1)])])]),_:1}),e(b,{prop:"role",label:"角色",width:"100"},{default:t(n=>[e(W,{type:_e(n.row.role)},{default:t(()=>[s(d(J(n.row.role)),1)]),_:2},1032,["type"])]),_:1}),e(b,{prop:"videoCount",label:"发布视频",width:"120"},{default:t(n=>[e(W,{size:"small"},{default:t(()=>[s(d(n.row.videoCount),1)]),_:2},1024)]),_:1}),e(b,{prop:"viewCount",label:"观看次数",width:"120"}),e(b,{prop:"status",label:"状态",width:"100"},{default:t(n=>[e(ye,{modelValue:n.row.status,"onUpdate:modelValue":T=>n.row.status=T,"active-value":"active","inactive-value":"disabled",onChange:T=>me(n.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(b,{prop:"registrationDate",label:"注册日期",width:"180"},{default:t(n=>[s(d(q(n.row.registrationDate)),1)]),_:1}),e(b,{label:"操作",width:"220",fixed:"right"},{default:t(n=>[e(p,{type:"primary",size:"small",onClick:T=>ue(n.row)},{default:t(()=>[...l[26]||(l[26]=[s("查看",-1)])]),_:1},8,["onClick"]),e(p,{type:"warning",size:"small",onClick:T=>se(n.row)},{default:t(()=>[...l[27]||(l[27]=[s("编辑",-1)])]),_:1},8,["onClick"]),e(p,{type:n.row.status==="active"?"danger":"success",size:"small",onClick:T=>ve(n.row)},{default:t(()=>[s(d(n.row.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"])),[[Pe,N.value]]),u("div",el,[w.value.length>0?(S(),$("div",ll,[u("span",null,"已选择 "+d(w.value.length)+" 个用户",1),e(p,{type:"success",onClick:ce},{default:t(()=>[...l[28]||(l[28]=[s("批量启用",-1)])]),_:1}),e(p,{type:"danger",onClick:pe},{default:t(()=>[...l[29]||(l[29]=[s("批量禁用",-1)])]),_:1})])):j("",!0),u("div",tl,[e(ze,{"current-page":f.value.currentPage,"onUpdate:currentPage":l[4]||(l[4]=n=>f.value.currentPage=n),"page-size":f.value.pageSize,"onUpdate:pageSize":l[5]||(l[5]=n=>f.value.pageSize=n),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:A.value.length,onSizeChange:fe,onCurrentChange:ge},null,8,["current-page","page-size","total"])])])]),_:1})]),_:1})]),_:1})]),_:1}),e(Y,{modelValue:L.value,"onUpdate:modelValue":l[6]||(l[6]=n=>L.value=n),title:"用户详情",width:"60%","before-close":G},{footer:t(()=>[e(p,{onClick:G},{default:t(()=>[...l[30]||(l[30]=[s("关闭",-1)])]),_:1})]),default:t(()=>[r.value?(S(),$("div",al,[u("div",nl,[e(Q,{size:80,src:r.value.avatar,class:"detail-avatar"},null,8,["src"]),u("div",ol,[u("h3",null,d(r.value.username),1),u("p",null,d(r.value.email),1),u("div",il,[e(F,{value:r.value.videoCount,label:"发布视频"},null,8,["value"]),e(F,{value:r.value.viewCount,label:"观看次数"},null,8,["value"]),e(F,{value:r.value.followerCount,label:"粉丝数"},null,8,["value"])])])]),e(Te),u("div",ul,[e(Se,{border:"",column:2},{default:t(()=>[e(h,{label:"用户ID"},{default:t(()=>[s(d(r.value.id),1)]),_:1}),e(h,{label:"角色"},{default:t(()=>[s(d(J(r.value.role)),1)]),_:1}),e(h,{label:"用户状态"},{default:t(()=>[s(d(we(r.value.status)),1)]),_:1}),e(h,{label:"注册日期"},{default:t(()=>[s(d(q(r.value.registrationDate)),1)]),_:1}),e(h,{label:"最后登录时间"},{default:t(()=>[s(d(r.value.lastLoginTime?q(r.value.lastLoginTime):"从未登录"),1)]),_:1}),e(h,{label:"账号等级"},{default:t(()=>[s(d(r.value.level),1)]),_:1}),e(h,{label:"简介",span:2},{default:t(()=>[s(d(r.value.bio||"暂无简介"),1)]),_:1})]),_:1})])])):j("",!0)]),_:1},8,["modelValue"]),e(Y,{modelValue:P.value,"onUpdate:modelValue":l[12]||(l[12]=n=>P.value=n),title:"编辑用户信息",width:"60%","before-close":R},{footer:t(()=>[e(p,{onClick:R},{default:t(()=>[...l[33]||(l[33]=[s("取消",-1)])]),_:1}),e(p,{type:"primary",onClick:re},{default:t(()=>[...l[34]||(l[34]=[s("保存修改",-1)])]),_:1})]),default:t(()=>[v.value?(S(),$("div",sl,[e(Le,{model:v.value,rules:ee,ref_key:"editFormRef",ref:B,"label-width":"120px"},{default:t(()=>[e(k,{label:"用户名",prop:"username"},{default:t(()=>[e(I,{modelValue:v.value.username,"onUpdate:modelValue":l[7]||(l[7]=n=>v.value.username=n),placeholder:"请输入用户名",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(k,{label:"邮箱",prop:"email"},{default:t(()=>[e(I,{modelValue:v.value.email,"onUpdate:modelValue":l[8]||(l[8]=n=>v.value.email=n),placeholder:"请输入邮箱",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(k,{label:"角色",prop:"role"},{default:t(()=>[e(M,{modelValue:v.value.role,"onUpdate:modelValue":l[9]||(l[9]=n=>v.value.role=n),placeholder:"请选择角色"},{default:t(()=>[e(m,{label:"管理员",value:"admin"}),e(m,{label:"普通用户",value:"user"}),e(m,{label:"审核员",value:"reviewer"})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"用户状态"},{default:t(()=>[e(M,{modelValue:v.value.status,"onUpdate:modelValue":l[10]||(l[10]=n=>v.value.status=n),placeholder:"请选择状态"},{default:t(()=>[e(m,{label:"正常",value:"active"}),e(m,{label:"禁用",value:"disabled"}),e(m,{label:"未激活",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"用户简介",prop:"bio"},{default:t(()=>[e(I,{modelValue:v.value.bio,"onUpdate:modelValue":l[11]||(l[11]=n=>v.value.bio=n),type:"textarea",rows:4,placeholder:"请输入用户简介",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(k,{label:"重置密码"},{default:t(()=>[e(p,{type:"danger",onClick:de},{default:t(()=>[...l[31]||(l[31]=[s("重置为默认密码",-1)])]),_:1}),l[32]||(l[32]=u("div",{class:"hint-text"},"默认密码: 123456",-1))]),_:1})]),_:1},8,["model"])])):j("",!0)]),_:1},8,["modelValue"])])}}},ml=Be(rl,[["__scopeId","data-v-b1ffba52"]]);export{ml as default};
