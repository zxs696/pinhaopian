# æ‹¼å¥½ç‰‡ (PinHaoPian)

ä¸€ä¸ªåŸºäºå‰åç«¯åˆ†ç¦»æ¶æ„çš„è§†é¢‘åˆ†äº«å¹³å°ï¼Œæä¾›è§†é¢‘ä¸Šä¼ ã€æ’­æ”¾ã€è¯„è®ºã€å¼¹å¹•ç­‰åŠŸèƒ½ï¼Œå¹¶åŒ…å«å®Œæ•´çš„ç®¡ç†åå°ç³»ç»Ÿã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [å¤šçª—å£ç™»å½•çŠ¶æ€ç®¡ç†](#å¤šçª—å£ç™»å½•çŠ¶æ€ç®¡ç†)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)

## ğŸ¯ é¡¹ç›®ç®€ä»‹

æ‹¼å¥½ç‰‡æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„è§†é¢‘åˆ†äº«å¹³å°ï¼Œæ”¯æŒç”¨æˆ·ä¸Šä¼ ã€è§‚çœ‹ã€è¯„è®ºè§†é¢‘ï¼Œå¹¶æä¾›å®æ—¶å¼¹å¹•åŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå‰ç«¯ä½¿ç”¨Vue3æ„å»ºå“åº”å¼ç•Œé¢ï¼Œåç«¯ä½¿ç”¨Spring Bootæä¾›RESTful APIæœåŠ¡ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Vue 3.5.22
- **æ„å»ºå·¥å…·**: Vite 5.0.0
- **UIåº“**: Element Plus 2.11.5
- **çŠ¶æ€ç®¡ç†**: Pinia 3.0.3
- **è·¯ç”±**: Vue Router 4.6.3
- **HTTPå®¢æˆ·ç«¯**: Axios 1.13.2
- **å›¾è¡¨**: @antv/g2 5.4.6
- **WebSocket**: @stomp/stompjs 7.2.1, sockjs-client 1.6.1
- **æ ·å¼**: Sass 1.94.2

### åç«¯
- **æ¡†æ¶**: Spring Boot 2.7.6
- **æ•°æ®åº“**: MySQL
- **ORM**: MyBatis Plus 3.5.3
- **ç¼“å­˜**: Redis
- **è®¤è¯**: Apache Shiro 1.9.1 + JWT
- **WebSocket**: Spring WebSocket
- **æ–‡ä»¶ä¸Šä¼ **: Commons FileUpload
- **å¯†ç åŠ å¯†**: Spring Security Crypto

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ç”¨æˆ·åŠŸèƒ½
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- è§†é¢‘ä¸Šä¼ /è§‚çœ‹
- è§†é¢‘è¯„è®º/å¼¹å¹•
- ä¸ªäººä¸­å¿ƒç®¡ç†
- å…³æ³¨/ç²‰ä¸ç³»ç»Ÿ
- åŠ¨æ€å‘å¸ƒ/æµè§ˆ

### ç®¡ç†åŠŸèƒ½
- å·¥ä½œå°æ¦‚è§ˆ
- ç”¨æˆ·ç®¡ç†
- è§†é¢‘ç®¡ç†
- åˆ†ç±»/æ ‡ç­¾ç®¡ç†
- è¯„è®º/å¼¹å¹•ç®¡ç†
- è§’è‰²æƒé™ç®¡ç†
- ç³»ç»Ÿè®¾ç½®
- æ•°æ®ç»Ÿè®¡/åˆ†æ
- ç³»ç»Ÿæ—¥å¿—/å¤‡ä»½

### ç³»ç»Ÿç‰¹æ€§
- JWTæ— çŠ¶æ€è®¤è¯
- å¤šè®¾å¤‡ç™»å½•æ£€æµ‹
- å¤šçª—å£ç™»å½•çŠ¶æ€åŒæ­¥
- ä¼šè¯å¤±æ•ˆå¤„ç†æœºåˆ¶
- å®æ—¶å¼¹å¹•ç³»ç»Ÿ
- å“åº”å¼è®¾è®¡
- è·¯ç”±æƒé™æ§åˆ¶
- æ–‡ä»¶ä¸Šä¼ ç®¡ç†

## ğŸ“ é¡¹ç›®ç»“æ„

```
pinhaopian/
â”œâ”€â”€ backend/                    # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ docs/                   # åç«¯æ–‡æ¡£
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ java/com/it/    # Javaæºç 
â”‚   â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚   â”‚       â”œâ”€â”€ db/         # æ•°æ®åº“è„šæœ¬
â”‚   â”‚   â”‚       â”œâ”€â”€ mapper/     # MyBatisæ˜ å°„æ–‡ä»¶
â”‚   â”‚   â”‚       â””â”€â”€ static/     # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ test/               # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ pom.xml                 # Mavené…ç½®
â”‚   â””â”€â”€ redis.conf              # Redisé…ç½®
â”œâ”€â”€ frontend/                   # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ public/                 # å…¬å…±èµ„æº
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/                # APIæ¥å£
â”‚   â”‚   â”œâ”€â”€ assets/             # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ components/         # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ layouts/            # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ router/             # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ services/           # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ stores/             # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ views/              # é¡µé¢è§†å›¾
â”‚   â”‚       â”œâ”€â”€ admin/          # ç®¡ç†åå°é¡µé¢
â”‚   â”‚       â”œâ”€â”€ auth/           # è®¤è¯ç›¸å…³é¡µé¢
â”‚   â”‚       â”œâ”€â”€ error/          # é”™è¯¯é¡µé¢
â”‚   â”‚       â””â”€â”€ index/          # å‰å°é¡µé¢
â”‚   â”œâ”€â”€ index.html              # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ package.json            # NPMé…ç½®
â”‚   â””â”€â”€ vite.config.js          # Viteé…ç½®
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
```

## ğŸš€ ç¯å¢ƒè¦æ±‚

- **Java**: JDK 1.8+
- **Node.js**: 16.0+
- **MySQL**: 5.7+
- **Redis**: 6.0+
- **Maven**: 3.6+

## ğŸƒâ€â™‚ï¸ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd pinhaopian
```

### 2. åç«¯å¯åŠ¨
```bash
cd backend

# é…ç½®æ•°æ®åº“è¿æ¥ï¼ˆå¯é€‰ï¼Œé»˜è®¤è¿æ¥æœ¬åœ°MySQLï¼‰
# ç¼–è¾‘ src/main/resources/application.properties

# å¯åŠ¨åç«¯æœåŠ¡
mvn spring-boot:run
```

åç«¯æœåŠ¡å°†åœ¨ http://localhost:8080 å¯åŠ¨

### 3. å‰ç«¯å¯åŠ¨
```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

å‰ç«¯æœåŠ¡å°†åœ¨ http://localhost:3000 å¯åŠ¨ï¼ˆå¦‚æœç«¯å£è¢«å ç”¨ä¼šè‡ªåŠ¨ä½¿ç”¨ä¸‹ä¸€ä¸ªå¯ç”¨ç«¯å£ï¼‰

### 4. è®¿é—®åº”ç”¨
- å‰å°é¡µé¢: http://localhost:3000
- ç®¡ç†åå°: http://localhost:3000/admin

## âš™ï¸ é…ç½®è¯´æ˜

### åç«¯é…ç½®

ä¸»è¦é…ç½®æ–‡ä»¶ï¼š`backend/src/main/resources/application.properties`

```properties
# æœåŠ¡å™¨ç«¯å£
server.port=8080

# æ•°æ®åº“é…ç½®
spring.datasource.url=jdbc:mysql://localhost:3306/pinhaopian?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=GMT%2B8
spring.datasource.username=root
spring.datasource.password=root

# Redisé…ç½®
spring.redis.host=localhost
spring.redis.port=6379
spring.redis.password=000000

# JWTé…ç½®
jwt.secret=pinhaopian_secret_key_2024
jwt.expiration=86400000

# æ–‡ä»¶ä¸Šä¼ é…ç½®
spring.servlet.multipart.max-file-size=100MB
spring.servlet.multipart.max-request-size=100MB
pinhaopian.file.upload-dir=uploads
```

### å‰ç«¯é…ç½®

ä¸»è¦é…ç½®æ–‡ä»¶ï¼š`frontend/vite.config.js`

```javascript
export default defineConfig({
  plugins: [vue()],
  server: {
    host: '0.0.0.0',
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true
      }
    }
  }
})
```

## ï¿½ å¤šçª—å£ç™»å½•çŠ¶æ€ç®¡ç†

### åŠŸèƒ½æ¦‚è¿°

ç³»ç»Ÿå®ç°äº†å®Œå–„çš„å¤šçª—å£ç™»å½•çŠ¶æ€ç®¡ç†æœºåˆ¶ï¼Œç¡®ä¿ç”¨æˆ·åœ¨å¤šä¸ªæµè§ˆå™¨çª—å£æˆ–æ ‡ç­¾é¡µä¸­çš„ç™»å½•çŠ¶æ€èƒ½å¤Ÿå®æ—¶åŒæ­¥ï¼Œå¹¶æ­£ç¡®å¤„ç†ä¼šè¯å¤±æ•ˆæƒ…å†µã€‚

### æ ¸å¿ƒç‰¹æ€§

- **çŠ¶æ€åŒæ­¥**: ç”¨æˆ·åœ¨ä»»ä¸€çª—å£ç™»å½•/ç™»å‡ºï¼Œæ‰€æœ‰çª—å£çŠ¶æ€åŒæ­¥æ›´æ–°
- **ä¼šè¯å¤±æ•ˆå¤„ç†**: å½“ä¼šè¯å¤±æ•ˆæ—¶ï¼Œæ‰€æœ‰çª—å£æ˜¾ç¤ºå¤±æ•ˆé€šçŸ¥å¹¶æä¾›é‡æ–°ç™»å½•é€‰é¡¹
- **é‡å¤å¤„ç†é˜²æŠ¤**: é˜²æ­¢åŒä¸€ä¼šè¯å¤±æ•ˆäº‹ä»¶è¢«å¤šæ¬¡å¤„ç†
- **è·¨çª—å£é€šä¿¡**: ä½¿ç”¨æµè§ˆå™¨å­˜å‚¨APIå®ç°çª—å£é—´é€šä¿¡
- **WebSocketé›†æˆ**: é€šè¿‡WebSocketå®æ—¶åŒæ­¥ä¼šè¯çŠ¶æ€

### æŠ€æœ¯å®ç°

- **æœåŠ¡å±‚**: `SessionService` è´Ÿè´£ä¼šè¯ç®¡ç†å’Œè·¨çª—å£é€šä¿¡
- **çŠ¶æ€ç®¡ç†**: `authStore` ä½¿ç”¨Piniaç®¡ç†è®¤è¯çŠ¶æ€
- **WebSocket**: `WebSocketService` å¤„ç†å®æ—¶æ¶ˆæ¯æ¨é€
- **è·¨çª—å£é€šä¿¡**: `CrossWindowService` å®ç°çª—å£é—´çŠ¶æ€åŒæ­¥

## ï¿½ï¿½ APIæ–‡æ¡£

### è®¤è¯æ¥å£
- `POST /auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /auth/login` - ç”¨æˆ·ç™»å½•
- `POST /auth/logout` - ç”¨æˆ·ç™»å‡º

### è§†é¢‘æ¥å£
- `GET /videos` - è·å–è§†é¢‘åˆ—è¡¨
- `GET /videos/{id}` - è·å–è§†é¢‘è¯¦æƒ…
- `POST /videos/upload` - ä¸Šä¼ è§†é¢‘
- `POST /videos/{id}/play` - æ’­æ”¾è§†é¢‘

### ç”¨æˆ·æ¥å£
- `GET /users/profile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PUT /users/profile` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `GET /users/{id}/videos` - è·å–ç”¨æˆ·è§†é¢‘åˆ—è¡¨

### è¯„è®ºæ¥å£
- `GET /comments/video/{videoId}` - è·å–è§†é¢‘è¯„è®º
- `POST /comments` - æ·»åŠ è¯„è®º
- `DELETE /comments/{id}` - åˆ é™¤è¯„è®º

### å¼¹å¹•æ¥å£
- `GET /danmu/video/{videoId}` - è·å–è§†é¢‘å¼¹å¹•
- `POST /danmu` - å‘é€å¼¹å¹•

## ğŸš€ éƒ¨ç½²æŒ‡å—

### åç«¯éƒ¨ç½²

1. æ‰“åŒ…åº”ç”¨
```bash
cd backend
mvn clean package
```

2. è¿è¡ŒJARæ–‡ä»¶
```bash
java -jar target/pinhaopian-0.0.1-SNAPSHOT.jar
```

### å‰ç«¯éƒ¨ç½²

1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
cd frontend
npm run build
```

2. éƒ¨ç½²distç›®å½•åˆ°WebæœåŠ¡å™¨ï¼ˆå¦‚Nginxï¼‰

### Nginxé…ç½®ç¤ºä¾‹

```nginx
server {
    listen 80;
    server_name yourdomain.com;
    
    # å‰ç«¯é™æ€èµ„æº
    location / {
        root /path/to/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # APIä»£ç†
    location /api {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    
    # æ–‡ä»¶ä¸Šä¼ 
    location /uploads {
        alias /path/to/uploads;
    }
}
```

## â“ å¸¸è§é—®é¢˜

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥
- æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦å¯åŠ¨
- ç¡®è®¤æ•°æ®åº“è¿æ¥é…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æƒé™

### 2. Redisè¿æ¥å¤±è´¥
- æ£€æŸ¥RedisæœåŠ¡æ˜¯å¦å¯åŠ¨
- ç¡®è®¤Redisè¿æ¥é…ç½®æ˜¯å¦æ­£ç¡®

### 3. æ–‡ä»¶ä¸Šä¼ å¤±è´¥
- æ£€æŸ¥ä¸Šä¼ ç›®å½•æ˜¯å¦å­˜åœ¨ä¸”æœ‰å†™æƒé™
- ç¡®è®¤æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡é™åˆ¶

### 4. å‰ç«¯é¡µé¢ç©ºç™½
- æ£€æŸ¥åç«¯APIæ˜¯å¦æ­£å¸¸å“åº”
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
- ç¡®è®¤APIä»£ç†é…ç½®æ˜¯å¦æ­£ç¡®

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ‘¥ ä½œè€…

- **å¼€å‘è€…** - [ç¥¥æ“å¯¼å¸ˆ|kellen|é˜¿ç¥¥]

## ğŸ™ è‡´è°¢

- [Vue.js](https://vuejs.org/) - æ¸è¿›å¼JavaScriptæ¡†æ¶
- [Spring Boot](https://spring.io/projects/spring-boot) - Javaåº”ç”¨æ¡†æ¶
- [Element Plus](https://element-plus.org/) - Vue3ç»„ä»¶åº“
- [MyBatis Plus](https://baomidou.com/) - MyBatiså¢å¼ºå·¥å…·